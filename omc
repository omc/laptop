#!/bin/sh

. ./mac

gem_install_or_update hookup

# various data services
brew_install_or_upgrade elasticsearch
brew_install_or_upgrade memcached
brew_install_or_upgrade zookeeper

# handy command line tools
brew_install_or_upgrade gh
brew_install_or_upgrade watch
brew_install_or_upgrade pdsh
brew_install_or_upgrade siege

# AWS credential stuff
sudo easy_install pip
sudo pip install awscli
gem install aws-keychain-util --no-rdoc --no-ri

# Elixir and Phoenix
brew_install_or_upgrade elixir
yes | mix local.hex

# Install brew cask
if ! brew help cask 2>&1 >/dev/null; then
  brew tap caskroom/cask
fi

# Cask installer
brew_cask_install() {
  package="$1"
  if brew cask info ${package} 2>&1 | grep -q "Not installed"; then
    brew cask install ${package}
  fi
}

# Install packages managed with brew cask
brew_cask_install java
brew_cask_install chefdk

# java build tools
brew_install_or_upgrade maven
brew_install_or_upgrade ant
brew_install_or_upgrade gradle

# Install Pow
if [ ! -f /Library/LaunchDaemons/cx.pow.firewall.plist ]; then
  curl get.pow.cx | sh
fi
